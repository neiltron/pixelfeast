!function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){var i=e[a][1][t];return o(i||t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(){requestAnimationFrame(o);var t=Date.now()-R;if(R=Date.now(),!(t>1e3)){b.save(),b.clearRect(0,0,M.width,M.height);var e=h.getScale(b);if(b.scale(e,e),I.default.translate(b),s.default.draw(b),D.default.length>0&&S.length>0){var i=I.default.getBounds();D.default.forEach(function(t,e){t.detectCollision(p.default)&&t.playerID!=p.default.id&&(D.default.splice(e,1),++p.default.hits>=4&&p.default.explode());for(var n=0;n<S.length;n++){var o=S[n];if(t.playerID!=o.id&&((!(o.position[1]+o.height<i.y||o.position[1]>i.y+i.h)||!(o.position[0]+o.width<i.x||o.position[0]>i.x+i.w))&&t.detectCollision(o))){o.explode(),D.default.splice(e,1);break}}Date.now()-t.created>4e3?D.default.splice(e,1):(t.update(),t.draw(b))})}S.forEach(function(e,i){e.scale<.4?S.splice(i,1):e.draw(b,t)}),l.default.draw(b),p.default.draw(b,t),(0,T.default)(b),b.restore()}}function r(){for(var t=0;t<50;t+=1)S.push(new v.default({position:[Math.random()*h.MAP_PIXEL_WIDTH,Math.random()*h.MAP_PIXEL_HEIGHT]}))}var a=t("./src/tiles"),s=n(a),u=t("./src/navigation"),l=n(u),c=t("./src/dimensions"),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(c),f=t("./src/copter"),d=(n(f),t("./src/player")),p=n(d),y=t("./src/enemy"),v=n(y),_=t("./src/camera"),I=n(_),g=t("./src/events"),E=n(g),w=t("./src/assets"),m=t("./src/projectiles"),D=n(m),O=t("./src/healthhud"),T=n(O),M=document.querySelector("canvas");M.width=512,M.height=512;var b=M.getContext("2d"),R=Date.now(),S=[];s.default.generate();var x=function(){var t=Math.min(window.innerWidth,window.innerHeight);M.width=t,M.height=t};x(),window.addEventListener("resize",x),window.addEventListener("keydown",function(t){E.default.keyDown.dispatch(t)}),window.addEventListener("keyup",function(t){E.default.keyUp.dispatch(t)}),(0,w.loadImages)().then(o).then(r)},{"./src/assets":3,"./src/camera":4,"./src/copter":5,"./src/dimensions":6,"./src/enemy":7,"./src/events":8,"./src/healthhud":9,"./src/navigation":10,"./src/player":11,"./src/projectiles":13,"./src/tiles":14}],2:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(){n(this,t),this._listeners=[],this._dispatchNb=0}return r(t,[{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{priority:0,once:!1,context:this},i=o({context:this},e,{function:t});if("function"!=typeof i.function)throw new TypeError("Signal.add() : First argument must be a Function");if(-1!==this._getListernerIndex(i.function,i.context))throw new Error("Signal.add() : Listener already exists");return this._listeners.push(i),this._listeners.sort(function(t,e){return t.priority<e.priority}),this}},{key:"once",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.add(t,o({},e,{once:!0}))}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if("function"!=typeof t)throw new TypeError("Signal.remove() : First argument must be a Function");var i=this._getListernerIndex(t,e);if(-1===i)throw new Error("Signal.remove() : Listener does not exist");return this._listeners.splice(i,1),this}},{key:"removeAll",value:function(){return this._listeners=[],this}},{key:"dispatch",value:function(){if(++this._dispatchNb>512)throw new Error("Signal.dispatch() : Maximum dispatch limit reached (prevent infinite loop)");for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=0;n<this._listeners.length;n++){var o,r=this._listeners[n];r.once&&this._listeners.splice(n);if(!1===(o=r.function).call.apply(o,[r.context].concat(e)))break}return this}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return-1!==this._getListernerIndex(t,e)}},{key:"getListenersNb",value:function(){return this._listeners.length}},{key:"getDispatchNb",value:function(){return this._dispatchNb}},{key:"_getListernerIndex",value:function(t,e){for(var i=0,n=this._listeners.length;i<n;i++)if(this._listeners[i].function===t&&this._listeners[i].context===e)return i;return-1}}]),t}();i.default=a,e.exports=i.default},{}],3:[function(t,e,i){"use strict";function n(){return Promise.all(Object.keys(a).map(function(t){return new Promise(function(e,i){var n=new Image;n.onload=function(){a[t]=n,e()},n.onerror=i,n.src=a[t]})})).then(function(){return r.default.imagesLoaded.dispatch(a),a})}Object.defineProperty(i,"__esModule",{value:!0}),i.images=void 0,i.loadImages=n;var o=t("./events"),r=function(t){return t&&t.__esModule?t:{default:t}}(o),a=i.images={drone:"./static/drone.png",drone_enemy:"./static/drone_enemy.png",grass:"./static/grass.png",road1:"./static/road1.png",road2:"./static/road2.png",road3:"./static/road3.png",house1:"./static/house-1.png",house2:"./static/house-2.png",house3:"./static/house-3.png",house4:"./static/house-4.png",house5:"./static/house-5.png",house6:"./static/house-6.png",house7:"./static/house-7.png",house8:"./static/house-8.png",house9:"./static/house-9.png",house10:"./static/house-10.png",explosion:"./static/explosion.png",navigation:"./static/navigation.png",healthhud_drone:"./static/healthhud_drone.png",package:"./static/package.png"}},{"./events":8}],4:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var o=t("./events"),r=n(o),a=t("./player"),s=n(a),u=t("./dimensions"),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u),c=t("./utils"),h=0,f=0,d=0,p=0,y=function t(e){if(Date.now()>e)return d=0,void(p=0);d=(0,c.rand)(-20,20),p=(0,c.rand)(-20,20),setTimeout(function(){return t(e)},25)};r.default.explode.add(function(){return y(Date.now()+200)}),i.default={translate:function(t){h=d+Math.max(0,Math.min(l.GRID_WIDTH*l.TILE_SIZE-l.VIEWPORT_WIDTH,s.default.position[0]-Math.floor(l.VIEWPORT_WIDTH/2))),f=p+Math.max(0,Math.min(l.GRID_HEIGHT*l.TILE_SIZE-l.VIEWPORT_HEIGHT,s.default.position[1]-Math.floor(l.VIEWPORT_HEIGHT/2))),t.translate(-Math.floor(h),-Math.floor(f))},getBounds:function(){return{x:h,y:f,w:l.VIEWPORT_WIDTH,h:l.VIEWPORT_HEIGHT}}}},{"./dimensions":6,"./events":8,"./player":11,"./utils":15}],5:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=t("./events"),s=n(a),u=t("./dimensions"),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u),c=t("./assets"),h=t("./projectiles"),f=n(h),d=t("./projectile"),p=n(d),y=t("./utils"),v=function(){function t(e){o(this,t),e=e||{},this.id=Math.floor(1e4*Math.random()),this.width=l.DRONE_SIZE,this.height=l.DRONE_SIZE,this.scale=1,this.velocityX=0,this.velocityY=0,this.acceleratorX=0,this.acceleratorY=0,this.leftDown=!1,this.rightDown=!1,this.center=[l.VIEWPORT_WIDTH/2-this.width/2,l.VIEWPORT_HEIGHT/2-this.height/2],this.position=e.position||[l.MAP_PIXEL_WIDTH/2-this.width/2,l.MAP_PIXEL_HEIGHT/2-this.height/2],this.rotation=0,this.hasPackage=!1,this.packageHeight=0,this.explosionFrame=-1,this.isActive=!0}return r(t,[{key:"update",value:function(t){"function"==typeof this._update&&this._update(t),this.velocityX+=this.acceleratorX*t,this.velocityY+=this.acceleratorY*t,this.velocityX=(0,y.clamp)(this.velocityX,-1,1),this.velocityY=(0,y.clamp)(this.velocityY,-1,1),this.checkOOB(),this.position[0]+=this.velocityX*t,this.position[1]+=this.velocityY*t,(this.leftDown||this.rightDown)&&this.leftDown!==this.rightDown&&(this.rotation+=.005*t*(this.leftDown?-1:1)),this.explosionFrame>0&&(this.scale-=.01,this.scale<=0&&(this.isActive=!1,this.scale=0,this.explosionFrame=-1,this.acceleratorX=this.acceleratorY=this.velocityX=this.velocityY=0))}},{key:"draw",value:function(t,e){this.update(e),this.explosionFrame>=0&&(this.explosionFrame+=.1),t.save(),t.translate(Math.floor(this.position[0]),Math.floor(this.position[1])),t.rotate(this.rotation),this.drawSprite(t),t.restore()}},{key:"drawSprite",value:function(t){this.hasPackage&&t.drawImage(c.images.package,48*this.scale/-2,6+this.packageHeight*this.scale,48*this.scale,48*this.scale),t.drawImage(c.images.drone,Math.floor(-l.DRONE_SIZE/2),Math.floor(-l.DRONE_SIZE/2),l.DRONE_SIZE*this.scale,l.DRONE_SIZE*this.scale),this.explosionFrame>0&&t.drawImage(c.images.explosion,64*Math.floor(Math.floor(this.explosionFrame)/5),Math.floor(this.explosionFrame)%5*64,64,64,-l.DRONE_SIZE/2,-l.DRONE_SIZE/2,l.DRONE_SIZE,l.DRONE_SIZE)}},{key:"moveLeft",value:function(){this.acceleratorX=-.002}},{key:"moveRight",value:function(){this.acceleratorX=.002}},{key:"moveUp",value:function(){this.acceleratorY=-.002}},{key:"moveDown",value:function(){this.acceleratorY=.002}},{key:"stopHorizontalMovement",value:function(){this.acceleratorX=0}},{key:"stopVerticalMovement",value:function(){this.acceleratorY=0}},{key:"shoot",value:function(){f.default.push(new p.default({direction:this.rotation,position:this.position.slice(),playerID:this.id}))}},{key:"explode",value:function(){this.explosionFrame=0,s.default.explode.dispatch()}},{key:"checkOOB",value:function(){this.position[0]<0?(this.position[0]=1,this.velocityX=.05,this.acceleratorX=5e-6):this.position[0]>l.MAP_PIXEL_WIDTH?(this.position[0]=l.GRID_WIDTH*l.TILE_SIZE,this.velocityX=-.05,this.acceleratorX=-5e-6):this.position[1]<0?(this.position[1]=1,this.velocityY=.05,this.acceleratorY=5e-6):this.position[1]>l.MAP_PIXEL_HEIGHT&&(this.position[1]=l.GRID_HEIGHT*l.TILE_SIZE,this.velocityY=-.05,this.acceleratorY=-5e-6)}},{key:"distanceFrom",value:function(t){var e=t.position[0]-this.position[0],i=t.position[1]-this.position[1];return Math.sqrt(e*e+i*i)}}]),t}();i.default=v},{"./assets":3,"./dimensions":6,"./events":8,"./projectile":12,"./projectiles":13,"./utils":15}],6:[function(t,e,i){"use strict";function n(t){var e=t.canvas,i=e.width,n=e.height;return i<n?i/o:n/r}Object.defineProperty(i,"__esModule",{value:!0}),i.getScale=n;var o=i.VIEWPORT_WIDTH=1024,r=i.VIEWPORT_HEIGHT=1024,a=i.TILE_SIZE=128,s=(i.DRONE_SIZE=128,i.GRID_WIDTH=128),u=i.GRID_HEIGHT=128;i.MAP_PIXEL_WIDTH=s*a,i.MAP_PIXEL_HEIGHT=u*a},{}],7:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=t("./copter"),l=n(u),c=t("./assets"),h=t("./dimensions"),f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(h),d=t("./player"),p=n(d),y=t("./utils"),v=function(t){function e(){return o(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"drawSprite",value:function(t){t.drawImage(c.images.drone_enemy,-f.DRONE_SIZE/2,-f.DRONE_SIZE/2,f.DRONE_SIZE*this.scale,f.DRONE_SIZE*this.scale),this.explosionFrame>0&&t.drawImage(c.images.explosion,64*Math.floor(Math.floor(this.explosionFrame)/5),Math.floor(this.explosionFrame)%5*64,64,64,-f.DRONE_SIZE/2,-f.DRONE_SIZE/2,f.DRONE_SIZE,f.DRONE_SIZE)}},{key:"_update",value:function(t){var e=this.distanceFrom(p.default);if(p.default.isActive&&e<f.VIEWPORT_WIDTH/1.1&&Math.random()>.98&&this.shoot(),p.default.isActive&&e<f.VIEWPORT_WIDTH){this.rotation=(0,y.getAngle)([this.position[0],this.position[1],p.default.position[0],p.default.position[1]]);var i=this.rotation<0&&this.rotation>Math.PI/-2||this.rotation>Math.PI&&this.rotation<1.5*Math.PI?-1:1,n=this.rotation>Math.PI/-2&&this.rotation<Math.PI/2?-1:1;this.acceleratorX=Math.random()/7500*i,this.acceleratorY=Math.random()/7500*n}else this.acceleratorX=(Math.random()-Math.random())/5e3,this.acceleratorY=(Math.random()-Math.random())/5e3}}]),e}(l.default);i.default=v},{"./assets":3,"./copter":5,"./dimensions":6,"./player":11,"./utils":15}],8:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=t("quark-signal"),o=function(t){return t&&t.__esModule?t:{default:t}}(n);i.default={keyDown:new o.default,keyUp:new o.default,imagesLoaded:new o.default,explode:new o.default}},{"quark-signal":2}],9:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var o=t("./player"),r=n(o),a=t("./dimensions"),s=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);e.default=t}(a),t("./assets")),u=t("./camera"),l=n(u);i.default=function(t){for(var e=l.default.getBounds(),i=0;i<4-r.default.hits;i+=1)t.drawImage(s.images.healthhud_drone,e.x+10+42*i,e.y+e.h-42,32,32)}},{"./assets":3,"./camera":4,"./dimensions":6,"./player":11}],10:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"__esModule",{value:!0});var o=t("./camera"),r=n(o),a=t("./player"),s=(n(a),t("./tiles")),u=t("./assets"),l={NORTH:[0,0],SOUTH:[1,0],EAST:[0,1],WEST:[1,1]},c=function(t,e,i,n,o,r){Date.now()%1e3<500||t.drawImage(u.images.navigation,16*e[0],16*e[1],16,16,i,n,o,r)};i.default={draw:function(t){var e=r.default.getBounds(),i=!0;if((s.targetLocation.x<e.x||s.targetLocation.x>e.x+e.w)&&(i=!1),(s.targetLocation.y<e.y||s.targetLocation.y>e.y+e.h)&&(i=!1),t.fillStyle="#f00",i)c(t,l.SOUTH,s.targetLocation.x-32,s.targetLocation.y-32,64,64);else{var n=s.targetLocation.x,o=s.targetLocation.y,a=l.SOUTH;n<e.x?(n=e.x,a=l.EAST):n>e.x+e.w&&(n=e.x+e.w-64,a=l.WEST),o<e.y?(o=e.y,a=l.NORTH):o>e.y+e.h&&(a=l.SOUTH,o=e.y+e.h-64),c(t,a,n,o,64,64)}}}},{"./assets":3,"./camera":4,"./player":11,"./tiles":14}],11:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=t("./events"),l=n(u),c=t("./copter"),h=n(c),f=function(t){function e(){o(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._handleKeyDown=t._handleKeyDown.bind(t),t._handleKeyUp=t._handleKeyUp.bind(t),t._bind(),t.hits=0,t.hasPackage=!0,t}return a(e,t),s(e,[{key:"_handleKeyDown",value:function(t){this.isActive&&("a"==t.key?this.moveLeft():"d"==t.key?this.moveRight():"w"==t.key?this.moveUp():"s"==t.key?this.moveDown():"ArrowLeft"==t.key?this.leftDown=!0:"ArrowRight"==t.key?this.rightDown=!0:"Space"==t.code&&this.shoot())}},{key:"_handleKeyUp",value:function(t){this.isActive&&("a"==t.key||"d"==t.key?this.stopHorizontalMovement():"w"==t.key||"s"==t.key?this.stopVerticalMovement():"ArrowLeft"==t.key?this.leftDown=!1:"ArrowRight"==t.key&&(this.rightDown=!1))}},{key:"_bind",value:function(){l.default.keyDown.add(this._handleKeyDown),l.default.keyUp.add(this._handleKeyUp)}}]),e}(h.default);i.default=new f},{"./copter":5,"./events":8}],12:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){n(this,t),this.playerID=e.playerID,this.created=Date.now(),this.direction=e.direction,this.velocity=20,this.position=e.position,this.width=8,this.height=164/6,this.image=new Image,this.image.src="./static/bullet.png"}return o(t,[{key:"update",value:function(){this.position[0]+=Math.sin(this.direction)*this.velocity,this.position[1]-=Math.cos(this.direction)*this.velocity}},{key:"draw",value:function(t){t.save(),t.translate(this.position[0],this.position[1]),t.rotate(this.direction),t.drawImage(this.image,1,0,this.width,this.height),t.restore()}},{key:"detectCollision",value:function(t){return this.position[0]>t.position[0]-t.width/2&&this.position[0]<t.position[0]+t.width/2&&this.position[1]>t.position[1]-t.height/2&&this.position[1]<t.position[1]+t.height/2}}]),t}();i.default=r},{}],13:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=[]},{}],14:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.targetLocation=void 0;var n=t("./utils"),o=t("./dimensions"),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(o),a=t("./assets"),s=t("./camera"),u=function(t){return t&&t.__esModule?t:{default:t}}(s),l={GRASS:0,ROAD_H:1,ROAD_V:2,ROAD_INTERSECTION:3,RESERVED:4},c=["grass","road1","road2","road3","grass"],h=void 0,f=[],d=function(){for(var t=0;t<r.GRID_WIDTH;t+=1)if(!(Math.random()<.75)){for(var e=0;e<r.GRID_HEIGHT;e+=1){var i=e*r.GRID_WIDTH+t;h[i]=h[i]===l.GRASS?l.ROAD_V:l.ROAD_INTERSECTION}t+=4}for(var n=0;n<r.GRID_HEIGHT;n+=1)if(!(Math.random()<.75)){for(var o=0;o<r.GRID_WIDTH;o+=1){var a=n*r.GRID_WIDTH+o;h[a]=h[a]===l.GRASS?l.ROAD_H:l.ROAD_INTERSECTION}n+=2}},p=function(){var t,e,i,o,a=!1;for(o=1;o<r.GRID_HEIGHT;o+=1){for(t=0,a=!1,i=0;i<r.GRID_WIDTH;i+=1)e=o*r.GRID_WIDTH+i,h[e]===l.GRASS?t+=1:t=0,t<2||(t=0,h[(o-1)*r.GRID_WIDTH+i]===l.GRASS&&(Math.random()<.1||(a=!0,h[e]=l.RESERVED,h[e-1]=l.RESERVED,f.push({image:"house"+(0,n.rand)(1,10),x:(i-1)*r.TILE_SIZE,y:(o-1)*r.TILE_SIZE,width:2*r.TILE_SIZE,height:2*r.TILE_SIZE,filter:"hue-rotate("+(0,n.rand)(0,360)+"deg)"}),i+=1)));a&&(o+=1)}},y=i.targetLocation={x:0,y:0};i.default={generate:function(){h=Array.from(Array(r.GRID_WIDTH*r.GRID_HEIGHT)).map(function(t){return l.GRASS}),d(),p();var t=f[(0,n.rand)(0,f.length)];y.x=t.x+Math.floor(t.width/2),y.y=t.y+Math.floor(t.height/2)},draw:function(t){var e=u.default.getBounds(),i=void 0,n=void 0,o=void 0;for(n=0;n<r.GRID_HEIGHT;n+=1)if(!((n+1)*r.TILE_SIZE<e.y||n*r.TILE_SIZE>e.y+e.h))for(o=0;o<r.GRID_WIDTH;o+=1)(o+1)*r.TILE_SIZE<e.x||o*r.TILE_SIZE>e.x+e.w||(i=h[n*r.GRID_WIDTH+o],t.drawImage(a.images[c[i]],Math.floor(o*r.TILE_SIZE),Math.floor(n*r.TILE_SIZE),r.TILE_SIZE,r.TILE_SIZE));t.save(),f.forEach(function(i){i.y+i.height<e.y||i.y>e.y+e.h||i.x+i.width<e.x||i.x>e.x+e.w||(t.filter=i.filter,t.drawImage(a.images[i.image],i.x,i.y,i.width,i.height))}),t.restore()}}},{"./assets":3,"./camera":4,"./dimensions":6,"./utils":15}],15:[function(t,e,i){"use strict";function n(t,e){return t+Math.floor(Math.random()*(e-t))}function o(t,e,i){return Math.min(Math.max(t,e),i)}function r(t){var e=a(t,4),i=e[0],n=e[1],o=e[2],r=e[3];return Math.atan2(r-n,o-i)+Math.PI/2}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){var i=[],n=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();i.rand=n,i.clamp=o,i.getAngle=r},{}]},{},[1]);
